var calendar={monthNamesFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["SUN","MON","TUE","WED","THU","FRI","SAT"],data:null,curDay:0,curMonth:0,curYear:0,draw:function(){calendar.curMonth=parseInt(document.getElementById("sMonth").value),calendar.curYear=parseInt(document.getElementById("sYear").value);var t=new Date(calendar.curYear,calendar.curMonth+1,0).getDate(),l=new Date(calendar.curYear,calendar.curMonth,1).getDay(),n=new Date(calendar.curYear,calendar.curMonth,t).getDay();calendar.data=localStorage.getItem("calendar"+calendar.curMonth+calendar.curYear),null==calendar.data?(localStorage.setItem("calendar"+calendar.curMonth+calendar.curYear,"{}"),calendar.data={}):calendar.data=JSON.parse(calendar.data);for(var r=[],a=0;a<l;a++)r.push(" ");for(var a=1;a<t+1;a++)r.push(a);for(var a=0;a<6-n;a++)r.push(" ");for(;r.length<42;)r.push(" ");var o=document.getElementById("calContainer"),s=document.createElement("table");s.id="calendar",o.innerHTML="";var c=document.createElement("tr");c.id="dayRow";for(var d=calendar.dayNames,i=d.length,u=document.createDocumentFragment(),a=0;a<i;a++){var m=document.createElement("td");m.innerHTML=d[a],u.appendChild(m)}c.appendChild(u),s.appendChild(c);let y=new Date,p=String(y.getDate()),g=document.createDocumentFragment();for(let v=0;v<6;v++){let h=document.createElement("tr");h.id="day";let E=0;for(let f=0;f<7;f++){let b=document.createElement("td");if(b.innerHTML=r[7*v+f]," "===r[7*v+f])b.id="empty",E++;else{let k=r[7*v+f];if(b.innerHTML=`<div class='cell'>${k}</div>`,calendar.data[k]){let I=y.getFullYear(),B=y.getMonth();if(calendar.curYear===I&&calendar.curMonth===B&&k==p){let $=calendar.data[k].replace(/\n/g,"<br>");b.innerHTML=`<div id="current-day" style="padding: 12px;"><div class='cell'>${k}</div>${$}</div>`,b.style.padding="0px",b.style.position="relative"}else{let L=calendar.data[k].replace(/\n/g,"<br>");b.innerHTML+=L}}else b.style.height="64px",calendar.curYear===y.getFullYear()&&calendar.curMonth===y.getMonth()&&k==p&&(b.innerHTML=`<div id="current-day" style="display: flex;"><div class='cell'>${k}</div></div>`,b.style.padding="0px",b.style.position="relative");b.addEventListener("click",()=>calendar.show(b))}h.appendChild(b)}7!==E&&g.appendChild(h)}s.appendChild(g),o.appendChild(s),calendar.close()},show:function(t){let l=document.getElementById("calEvent"),n=document.createElement("form");n.addEventListener("submit",calendar.save),l.innerHTML="",calendar.curDay=t.querySelector(".cell").textContent;let r="<h1>"+(calendar.data[calendar.curDay]?"EDIT EVENT":"ADD EVENT")+"</h1>";r+="<p>"+calendar.monthNamesFull[calendar.curMonth]+" "+calendar.curDay+", "+calendar.curYear+"</p>",r+="<textarea id='inputDetails' required>"+(calendar.data[calendar.curDay]||"")+"</textarea>",r+="<input type='button' value='Delete' onclick='calendar.delete()'/>",r+="<input type='button' value='Cancel' onclick='calendar.close()'/>",r+="<input type='submit' value='Save'/>",n.innerHTML=r,l.appendChild(n),l.style.display="block",setTimeout(()=>l.classList.add("show"),0);let a=l.querySelector("textarea");a.focus(),a.setSelectionRange(a.value.length,a.value.length),document.addEventListener("click",closeOnClick),document.addEventListener("keydown",closeOnClick)},save:function(t){t.stopPropagation(),t.preventDefault(),calendar.data[calendar.curDay]=document.getElementById("inputDetails").value,localStorage.setItem("calendar"+calendar.curMonth+calendar.curYear,JSON.stringify(calendar.data)),calendar.draw()},delete:function(){if(calendar.data[calendar.curDay])delete calendar.data[calendar.curDay],localStorage.setItem("calendar"+calendar.curMonth+calendar.curYear,JSON.stringify(calendar.data)),calendar.draw();else{var t=document.getElementById("calEvent").querySelector("textarea");t.value="",t.focus()}},close:function(){(e=document.getElementById("calEvent")).classList.remove("show"),e.style.display="none",document.removeEventListener("click",closeOnClick)}};function documentKeyHandler(t){if("Tab"===t.key){if("none"===document.getElementById("calEvent").style.display){t.preventDefault();var l,n=localStorage.getItem("panel-main");"calendar"==n?l="notes":"notes"==n&&(l="calendar"),openMode(l)}}else t.ctrlKey&&"s"===t.key&&"block"==document.getElementById("notes").style.display&&(t.preventDefault(),saveNote())}function logoClick(){let t=document.getElementById("logo");if("#F5F5F5"===localStorage.getItem("colour-mode-back")||null===localStorage.getItem("colour-mode-back"))t.classList.remove("animate"),t.offsetWidth,t.classList.add("animate");else{let l=document.querySelector(".zzz-container"),n=l.querySelectorAll("div");n.forEach(function(t){t.classList.add("zzz-animate"),t.textContent="Z",t.addEventListener("animationend",function(){t.classList.remove("zzz-animate"),t.textContent=""})}),t.classList.remove("pulse"),t.offsetWidth,t.classList.add("pulse")}}function popupClick(){let t=document.querySelector(".popup");localStorage.setItem("popup-dismissed","true"),t.style.display="none"}function collToggle(){this.classList.toggle("active");var t=this.nextElementSibling;t.style.maxHeight?t.style.maxHeight=null:t.style.maxHeight=t.scrollHeight+"px"}function closeOnClick(t){calEvent=document.getElementById("calEvent"),"click"==t.type?!document.querySelector("#calEvent").classList.contains("show")||calEvent.contains(t.target)||t.target.closest("td")&&"dayRow"!=t.target.closest("tr").id&&"empty"!=t.target.closest("td").id||(calendar.close(),document.removeEventListener("click",closeOnClick)):"keydown"==t.type&&"Escape"===t.key&&(calendar.close(),document.removeEventListener("keydown",closeOnClick))}function getTextColor(t){let l=parseInt(t.substr(1,2),16),n=parseInt(t.substr(3,2),16),r=parseInt(t.substr(5,2),16);return .299*l+.587*n+.114*r>186?"#424242":"#F5F5F5"}function toggleDarkMode(){let t=document.querySelector("#darkmode-button img"),l=document.querySelector("#logo img"),n="#F5F5F5",r="#424242";"images/light-mode.png"===t.getAttribute("src")?(t.src="images/dark-mode.png",l.src="images/logo-awake.png",document.documentElement.style.setProperty("--bodyback","#E8E8E8"),document.documentElement.style.setProperty("--popupback","#646464"),document.documentElement.style.setProperty("--modeback",n),document.documentElement.style.setProperty("--modetext",r),localStorage.setItem("popup-back","#646464"),localStorage.setItem("colour-mode-back",n),localStorage.setItem("colour-mode-text",r)):(t.src="images/light-mode.png",l.src="images/logo-asleep.png",document.documentElement.style.setProperty("--bodyback","#363636"),document.documentElement.style.setProperty("--popupback","#E8E8E8"),document.documentElement.style.setProperty("--modeback",r),document.documentElement.style.setProperty("--modetext",n),localStorage.setItem("popup-back","#E8E8E8"),localStorage.setItem("colour-mode-back",r),localStorage.setItem("colour-mode-text",n))}function hexToHsv(t){var l,n,r,a=parseInt(t.substring(1,3),16),o=parseInt(t.substring(3,5),16),s=parseInt(t.substring(5,7),16),c=Math.max(a,o,s),d=c-Math.min(a,o,s);return n=0===c?0:d/c,0===d?l=0:(l=a===c?(o-s)/d:o===c?2+(s-a)/d:4+(a-o)/d,(l*=60)<0&&(l+=360)),{h:l,s:n,v:r=c/255}}function hsvToHex(t){"string"==typeof t&&(t=JSON.parse(t));var l,n,r,a=t.v*t.s,o=a*(1-Math.abs(t.h/60%2-1)),s=t.v-a;return t.h>=0&&t.h<60?(l=a,n=o,r=0):t.h>=60&&t.h<120?(l=o,n=a,r=0):t.h>=120&&t.h<180?(l=0,n=a,r=o):t.h>=180&&t.h<240?(l=0,n=o,r=a):t.h>=240&&t.h<300?(l=o,n=0,r=a):(l=a,n=0,r=o),l=Math.round((l+s)*255),"#"+(16777216+(l<<16)+((n=Math.round((n+s)*255))<<8)+(r=Math.round((r+s)*255))).toString(16).slice(1)}function generatePalette(t){var l={},n=t.v-.21;n<0&&(n=t.v+.21);var r=t.v+.08;if(r>1&&(r=t.v-.08),10>Math.abs(98.5-t.h))var a=Math.abs(360-t.h);else var a=Math.abs(197-t.h);var o=t.v+.08;return o>1&&(o=t.v-.08),l.c1={h:t.h,s:t.s,v:n},l.c2={h:t.h,s:t.s,v:r},l.c3={h:a,s:t.s,v:t.v},l.c4={h:a,s:t.s,v:o},l}function openMode(t){var l,n,r;for(l=0,n=document.getElementsByClassName("mode");l<n.length;l++)n[l].style.display="none";for(l=0,r=document.getElementsByClassName("panel-mode");l<n.length;l++)r[l].style.borderBottom="6px solid #646464",r[l].style.color="#646464";document.getElementById(t).style.display="block",document.getElementById(t+"-select").style.borderBottom="6px solid var(--top)",document.getElementById(t+"-select").style.color="var(--top)","notes"==t?(localStorage.setItem("panel-main","notes"),document.getElementById("editor").focus()):"calendar"==t&&(localStorage.setItem("panel-main","calendar"),document.querySelector(".search-bar form input").focus())}function saveNote(){localStorage.setItem("notes-main",document.getElementById("editor").value),document.getElementById("editor-save-btn").textContent="Save",document.getElementById("editor-alert").style.display="none"}function indicateSave(){document.getElementById("editor-save-btn").textContent="*Save",document.getElementById("editor-alert").style.display="block"}function getUrlsFromStorage(){let t=JSON.parse(localStorage.getItem("urls"))||[],l=JSON.parse(localStorage.getItem("url_values"))||[];return{urls:t,values:l}}function saveUrlsToStorage(t,l){localStorage.setItem("urls",JSON.stringify(t)),localStorage.setItem("url_values",JSON.stringify(l))}function addUrlButton(){let t=document.getElementById("urlButtonContainer"),l=document.getElementById("urlDivider"),n=document.createElement("button");n.className="urlButton",n.onclick=function(){goToUrl(this)},n.innerHTML="+ New";let r=document.createElement("button");r.className="minusButton",r.onclick=function(){deleteUrlButton(this)},r.innerHTML="-",t.insertBefore(n,l),t.insertBefore(r,l),localStorage.setItem("emptyURL",!1),updateURLVisibility()}function deleteUrlButton(t){let l=document.getElementById("urlButtonContainer"),n=Array.from(l.children).indexOf(t),r=l.children[n-1],{urls:a,values:o}=getUrlsFromStorage();if(r.dataset.url){let s=a.findIndex(t=>t===r.dataset.url),c=o.findIndex(t=>t===r.dataset.value);s>-1&&a.splice(s,1),c>-1&&o.splice(c,1),saveUrlsToStorage(a,o)}l.removeChild(l.children[n]),l.removeChild(l.children[n-1]),updateURLVisibility()}function updateURLVisibility(){let t=document.getElementById("urlButtonContainer"),l=t.getElementsByClassName("urlButton").length>0;var n=this.localStorage.getItem("emptyURL");if(l&&"true"!=n){t.classList.add("hasSeturlButtons"),localStorage.setItem("emptyURL",!1);var r=document.querySelector(".urlButton.initial"),a=document.querySelector(".minusButton.initial");r&&a&&(r.style.display="block",a.style.display="block")}else t.classList.remove("hasSeturlButtons"),localStorage.setItem("emptyURL","true");"true"==n&&(t.removeChild(t.children[1]),t.removeChild(t.children[0]))}function goToUrl(t){var l=prompt("Enter the URL:"),n=prompt("(Optional) Enter the name:");if(""!==l&&null!=l){(""==n||null==n)&&(n=l.replace(/^(https?:\/\/)?(www\.)?/,"").substring(0,8),l.length>8&&(n+="..")),setupUrlButtons(t,l,n);let{urls:r,values:a}=getUrlsFromStorage();r.push(l),a.push(n),saveUrlsToStorage(r,a)}}function openAllUrls(){let t=document.querySelectorAll(".urlButton");if(t.length>0)for(let l=0;l<t.length;l++){var n=t[l].dataset.url;""!==n&&null!=n&&(n.startsWith("http://")||n.startsWith("https://")||(n="https://"+n),window.open(n,"_blank"))}}function initUrlButtons(){let{urls:t,values:l}=getUrlsFromStorage(),n=document.getElementById("urlButtonContainer"),r=document.getElementById("urlDivider");t.forEach((t,a)=>{let o=document.createElement("button");o.className="urlButton",setupUrlButtons(o,t,l[a]);let s=document.createElement("button");s.className="minusButton",s.onclick=function(){deleteUrlButton(this)},s.innerHTML="-",n.insertBefore(o,r),n.insertBefore(s,r)}),updateURLVisibility()}function setupUrlButtons(t,l,n){t.dataset.value=n,t.dataset.url=l;var r=l;l.startsWith("http://")||l.startsWith("https://")||(r="https://"+l),t.onclick=function(){window.location.href=r},t.innerText=n,t.style.borderStyle="solid",t.style.borderRight="none"}window.addEventListener("load",function(){for(var t,l=new Date,n=document.getElementById("sMonth"),r=document.getElementById("sYear"),t=0;t<12;t++){var a=document.createElement("option");a.value=t,a.innerHTML=calendar.monthNames[t],t==l.getMonth()&&(a.selected=!0),n.appendChild(a)}for(var t=2023;t<l.getFullYear()+6;t++){var a=document.createElement("option");a.value=t,a.innerHTML=t,t==l.getFullYear()&&(a.selected=!0),r.appendChild(a)}document.getElementById("btnShow").addEventListener("click",calendar.draw),calendar.draw(),document.addEventListener("keydown",documentKeyHandler);var o=localStorage.getItem("panel-main")||"calendar";document.getElementById(o).style.display="block",document.getElementById(o+"-select").style.borderBottom="6px solid var(--top)",document.getElementById(o+"-select").style.color="var(--top)",localStorage.setItem("panel-main",o);var s=localStorage.getItem("colour-main")||"#ed6461",c=hexToHsv(s),d=localStorage.getItem("colour-mode-back")||"#F5F5F5",i=localStorage.getItem("colour-mode-text")||"#424242",u=localStorage.getItem("popup-back")||"#646464",m=generatePalette(c);document.documentElement.style.setProperty("--main",s),document.documentElement.style.setProperty("--modeback",d),document.documentElement.style.setProperty("--modetext",i),document.documentElement.style.setProperty("--popupback",u),document.documentElement.style.setProperty("--header",getTextColor(hsvToHex(m.c3))),document.documentElement.style.setProperty("--text",getTextColor(s)),document.documentElement.style.setProperty("--empty",hsvToHex(m.c1)),document.documentElement.style.setProperty("--hover",hsvToHex(m.c2)),document.documentElement.style.setProperty("--top",hsvToHex(m.c3)),document.documentElement.style.setProperty("--tophover",hsvToHex(m.c4));let y=document.querySelector(".colour-picker-button"),p=document.querySelector(".colour-picker-button img");p.src="images/colour-wheel.png",y.addEventListener("click",function(){let t=document.createElement("input");t.type="color",t.addEventListener("change",function(){var l=t.value,n=hexToHsv(l),r=generatePalette(n);document.documentElement.style.setProperty("--main",l),document.documentElement.style.setProperty("--header",getTextColor(hsvToHex(r.c3))),document.documentElement.style.setProperty("--text",getTextColor(l)),document.documentElement.style.setProperty("--empty",hsvToHex(r.c1)),document.documentElement.style.setProperty("--hover",hsvToHex(r.c2)),document.documentElement.style.setProperty("--top",hsvToHex(r.c3)),document.documentElement.style.setProperty("--tophover",hsvToHex(r.c4)),localStorage.setItem("colour-main",l)}),t.click(),t.addEventListener("blur",function(){t.remove()}),document.addEventListener("click",function(l){t.contains(l.target)||l.target===y||t.remove()})});let g=document.querySelector("#darkmode-button"),v=document.querySelector("#darkmode-button img"),h=document.querySelector("#logo img");"#424242"==d?(v.src="images/light-mode.png",h.src="images/logo-asleep.png",document.documentElement.style.setProperty("--bodyback","#363636")):(v.src="images/dark-mode.png",h.src="images/logo-awake.png",document.documentElement.style.setProperty("--bodyback","#E8E8E8")),g.addEventListener("click",toggleDarkMode);let E=document.querySelector(".popup");localStorage.getItem("popup-dismissed")?E.style.display="none":E.style.display="block",document.getElementById("close-popup").addEventListener("click",popupClick);var f=document.getElementsByClassName("collapsible");for(t=0;t<f.length;t++)f[t].addEventListener("click",collToggle);document.getElementById("logo").addEventListener("click",logoClick);var b=document.querySelector(".search-bar form input");b.focus(),b.style.background="var(--modeback)";var b=document.querySelector(".search-bar form button");b.style.background="var(--main)",document.querySelector(".panel-select").style.background="var(--modeback)",document.querySelector("#plusButton").style.display="block",initUrlButtons();var k=JSON.parse(localStorage.getItem("urls"));if(k&&k.length>0){let I=document.getElementById("urlButtonContainer");I.removeChild(I.children[1]),I.removeChild(I.children[0])}let B=localStorage.getItem("notes-main")||"";document.getElementById("editor").value=B,document.getElementById("editor-save-btn").addEventListener("click",saveNote),document.getElementById("editor").addEventListener("input",indicateSave)});