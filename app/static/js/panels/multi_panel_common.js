function getUrlParams(){let e=new URLSearchParams(window.location.search);return{panelIndex:e.get("index"),isPopped:e.get("popped")}}function loadSidepanel(e){let t=JSON.parse(localStorage.getItem("panel-order")).length,{panelIndex:n}=getUrlParams(),l=JSON.parse(localStorage.getItem(`vals-${e}`))||[],i=JSON.parse(localStorage.getItem(`orders-${e}`))||Array(t),s=document.getElementById("sidebar-list");s.innerHTML="",l.forEach((t,l)=>{let r=document.createElement("li");l===i[n]-1&&r.classList.add("selected");let a=document.createElement("button");a.innerHTML="&#10006;",a.classList.add("remove-btn"),a.addEventListener("click",t=>{t.stopPropagation(),removeMulti(e,l)}),r.textContent=t[0],r.appendChild(a),r.addEventListener("click",()=>switchMulti(e,n,l)),s.appendChild(r)});let r=document.createElement("button");r.textContent="NEW",r.classList.add("new-btn"),r.addEventListener("click",t=>newMulti(e,t)),s.appendChild(r),document.getElementById("sidebar").style.width="300px",document.getElementById("sidebar").style.marginRight="8px"}function removeMulti(e,t){let n=JSON.parse(localStorage.getItem("panel-order")).length,l=JSON.parse(localStorage.getItem(`orders-${e}`))||Array(n),{panelIndex:i}=getUrlParams();t===l[i]-1&&("note"==e?document.getElementById("note-editor").value="":"checklist"==e&&(document.getElementById("checklist-list").innerHTML=""),document.getElementById("main-title").textContent="Untitled");let s=JSON.parse(localStorage.getItem(`vals-${e}`));if(1===s.length)localStorage.setItem(`vals-${e}`,"[]"),localStorage.setItem(`orders-${e}`,JSON.stringify(Array(n)));else{s.splice(t,1);for(let r=0;r<l.length;r++)l[r]===t+1?l[r]=null:l[r]>t+1&&(l[r]-=1);localStorage.setItem(`vals-${e}`,JSON.stringify(s)),localStorage.setItem(`orders-${e}`,JSON.stringify(l))}loadSidepanel(e)}function switchMulti(e,t,n){let l=JSON.parse(localStorage.getItem("panel-order")).length,i=JSON.parse(localStorage.getItem(`orders-${e}`))||Array(l);i[t]=n+1,localStorage.setItem(`orders-${e}`,JSON.stringify(i)),loadSidepanel(e),"note"==e?loadNote():"checklist"==e&&loadChecklist()}function newMulti(e,t){t.stopPropagation();let{panelIndex:n}=getUrlParams(),l=JSON.parse(localStorage.getItem(`vals-${e}`))||[];l.push(["Untitled",""]),localStorage.setItem(`vals-${e}`,JSON.stringify(l)),switchMulti(e,n,l.length-1)}function titleEditable(e){e.contentEditable="true",e.focus()}window.addEventListener("load",function(){document.getElementById("main-title").addEventListener("keydown",e=>{["Enter","Escape"].includes(e.key)&&(e.preventDefault(),e.target.blur())})});